(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{RJM5:function(e,a,t){"use strict";t.r(a),function(e){t("IzEo");var n=t("bx4M"),s=(t("fOrg"),t("+KLJ")),l=(t("5NDa"),t("5rEg")),r=t("eHn4"),i=t.n(r),o=(t("y8nQ"),t("Vl3Y")),c=(t("2qtc"),t("kLXV")),m=(t("miYZ"),t("tsqr")),d=t("2Taf"),u=t.n(d),p=t("vZ4D"),h=t.n(p),f=t("l4Ni"),E=t.n(f),w=t("ujKo"),v=t.n(w),g=t("MhPg"),b=t.n(g),y=(t("aHsQ"),t("sGsY")),k=(t("B9cy"),t("Ol7k")),C=t("q1tI"),S=t.n(C),_=(t("XlDN"),t("R+Pm")),I=t("G3dp"),T=t("vDqi"),N=t.n(T),P=t("jHKv"),A=(t("kQFk"),t("gtCd")),B=t.n(A),x=k.a.Content,V=y.a.Countdown,F=Object(_.a)({scriptUrl:e.constants.iconUrl}),O={labelCol:{span:6},wrapperCol:{span:14}},R=function(e){function a(e){var t;return u()(this,a),(t=E()(this,v()(a).call(this,e))).formRef=S.a.createRef(),t.onOk=function(){t.formRef.current.validateFields().then(function(e){void 0==e.newEmail||void 0==e.newEmail2||e.newEmail==e.newEmail2?t.props.handleAdd(e):m.a.error("两次邮箱不一致！",2)}).catch(function(e){})},t.state={email:e.formValues.email,userId:e.formValues.user_id},t}return b()(a,e),h()(a,[{key:"render",value:function(){var e=this.props,a=e.visible,t=e.onCancel,n=(e.onCreate,e.formValues.email);return S.a.createElement(c.a,{visible:a,title:"修改邮箱",okText:"确认",onCancel:t,onOk:this.onOk,width:600,centered:!0,className:B.a.inputItem},S.a.createElement(o.a,Object.assign({},O,{ref:this.formRef,name:"userForm",initialValues:i()({},"email",n)}),S.a.createElement(o.a.Item,{name:"email",label:"邮箱"},S.a.createElement(l.a,{disabled:!0})),S.a.createElement(o.a.Item,{name:"password",label:"密码验证",validateTrigger:"onBlur",rules:[{required:!0,pattern:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[^]{8,16}$/,message:"密码限8-20个字符，且同时包含大小写字母",min:8,max:20}]},S.a.createElement(l.a.Password,{type:"password",placeholder:"请输入dataone登录密码"})),S.a.createElement(o.a.Item,{name:"newEmail",label:"新邮箱",validateTrigger:"onBlur",rules:[{required:!0,whitespace:!0,message:"邮箱不能为空，请输入邮箱地址"},{type:"email",message:"您输入的邮箱格式错误，请重新输入！"}]},S.a.createElement(l.a,{type:"email",placeholder:"请输入新邮箱地址"})),S.a.createElement(o.a.Item,{name:"newEmail2",label:"确认邮箱",validateTrigger:"onBlur",rules:[{required:!0,whitespace:!0,message:"邮箱不能为空，请输入邮箱地址"},{type:"email",message:"您输入的邮箱格式错误，请重新输入！"}]},S.a.createElement(l.a,{type:"email",placeholder:"请再次确认新邮箱地址"}))))}}]),a}(C.PureComponent),q=function(e){function a(){var e;return u()(this,a),(e=E()(this,v()(a).apply(this,arguments))).formRef=S.a.createRef(),e.onOk=function(){e.formRef.current.validateFields().then(function(a){void 0==a.newPassword||a.newPassword==a.newPassword2?e.props.handleAdd(a):m.a.error("两次密码不一致！",2)}).catch(function(e){})},e}return b()(a,e),h()(a,[{key:"render",value:function(){var e=this.props,a=e.visible,t=e.onCancel;e.onCreate;return S.a.createElement(c.a,{visible:a,title:"修改密码",okText:"确认",onCancel:t,onOk:this.onOk,width:600,centered:!0,className:B.a.inputItem},S.a.createElement(o.a,Object.assign({},O,{ref:this.formRef}),S.a.createElement(o.a.Item,{name:"password",label:"原密码",validateTrigger:"onBlur",rules:[{required:!0,pattern:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[^]{8,16}$/,message:"密码限8-20个字符，且同时包含大小写字母",min:8,max:20}]},S.a.createElement(l.a.Password,{type:"password",placeholder:"请输入原密码"})),S.a.createElement(o.a.Item,{name:"newPassword",label:"新密码",validateTrigger:"onBlur",rules:[{required:!0,pattern:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[^]{8,16}$/,message:"密码限8-20个字符，且同时包含大小写字母",min:8,max:20}]},S.a.createElement(l.a.Password,{type:"password",placeholder:"请输入新密码"})),S.a.createElement(o.a.Item,{name:"newPassword2",label:"确认密码",validateTrigger:"onBlur",rules:[{required:!0,pattern:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[^]{8,16}$/,message:"密码限8-20个字符，且同时包含大小写字母",min:8,max:20}]},S.a.createElement(l.a.Password,{type:"password",placeholder:"请再次输入新密码"}))))}}]),a}(S.a.Component),j=function(e){function a(e){var t;return u()(this,a),(t=E()(this,v()(a).call(this,e))).formRef=S.a.createRef(),t.onOk=function(){t.formRef.current.validateFields().then(function(e){void 0==e.newPassword||e.newPassword==e.newPassword2?t.props.handleAdd(e):m.a.error("两次密码不一致！",2)}).catch(function(e){})},t.state={email:e.formValues.email,userId:e.formValues.user_id},t}return b()(a,e),h()(a,[{key:"render",value:function(){var e=this.props,a=e.visible,t=e.onCancel;e.onCreate;return S.a.createElement(c.a,{visible:a,title:"修改系统邮箱",okText:"确认",onCancel:t,onOk:this.onOk,bodyStyle:{padding:0},width:600,centered:!0},S.a.createElement(s.a,{message:S.a.createElement("div",{style:{color:"rgba(64, 138, 255, 0.7)",fontSize:14}},S.a.createElement(F,{type:"iconwenhao1"}),S.a.createElement("span",null,"『修改邮箱』: 1.绑定系统邮箱后会自动抓取系统内所有任务的数据任务错误信息、错误队列预警、错误队列暂停、数据源变化通知，上述消息会通过系统邮箱发送至各个任务的参与人邮箱 2.请准确填写邮箱授权码，否则将导致消息无法发送至参与人邮箱")),banner:!0,showIcon:!1,style:{color:"#408AFF",background:"#F5F9FD",padding:"15px",marginBottom:10,fontSize:12}}),S.a.createElement(o.a,Object.assign({},O,{ref:this.formRef,initialValues:i()({},"email",this.state.email)}),S.a.createElement(o.a.Item,{name:"email",label:"邮箱",validateFirst:!0,validateTrigger:"onBlur",rules:[{required:!0,whitespace:!0,message:"邮箱不能为空，请输入邮箱地址"},{type:"email",message:"您输入的邮箱格式错误，请重新输入！"}]},S.a.createElement(l.a,{disabled:!0})),S.a.createElement(o.a.Item,{name:"password",label:"密码验证",validateTrigger:"onBlur",rules:[{required:!0,pattern:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[^]{8,16}$/,message:"密码限8-20个字符，且同时包含大小写字母",min:8,max:20}]},S.a.createElement(l.a.Password,{type:"password",placeholder:"请输入dataone登录密码"})),S.a.createElement(o.a.Item,{name:"newEmail",label:"新邮箱",validateTrigger:"onBlur",rules:[{required:!0,whitespace:!0,message:"邮箱不能为空，请输入邮箱地址"},{type:"email",message:"您输入的邮箱格式错误，请重新输入！"}]},S.a.createElement(l.a,{type:"email",placeholder:"请输入新邮箱地址"})),S.a.createElement(o.a.Item,{name:"emailPassword",label:"邮箱授权码",validateTrigger:"onBlur",rules:[{required:!0,message:"邮箱授权码必填"}]},S.a.createElement(l.a.Password,{type:"password",placeholder:"请输入正确的邮箱授权码"}))))}}]),a}(S.a.Component),z=function(a){function t(a){var n;return u()(this,t),(n=E()(this,v()(t).call(this,a))).formRef=S.a.createRef(),n.onOk=function(){n.formRef.current.validateFields().then(function(e){void 0==e.newEmail||void 0==e.newEmail2||e.newEmail==e.newEmail2?n.props.handleAdd(e):m.a.error("两次邮箱不一致！",2)}).catch(function(e){})},n.onFinish=function(){n.setState({verification:!0,reload:!1})},n.getverification=function(){var a={email:n.state.value};N()({method:"post",url:e.constants.httpType+e.constants.website+"/sys_user/sendCode",headers:{authToken:localStorage.getItem("authToken")},data:P.a.Amap(a)}).then(function(e){"401"==e.data.status&&(window.location.href="/user"),1==e.data.status?(n.setState({verification:!1,deadline:Date.now()+6e4}),m.a.success("验证码已发送至您的邮箱，请到邮箱中获取")):m.a.error(e.data.message,2)}).catch(function(e){})},n.state={verification:!0,skill_email:a.formValues.skill_email,userId:a.formValues.user_id,deadline:Date.now()+6e4,color:!1,reload:!0,value:""},n}return b()(t,a),h()(t,[{key:"render",value:function(){var e=this,a=this.props,t=a.visible,n=a.onCancel;return S.a.createElement(c.a,{visible:t,title:"修改技术支持邮箱",okText:"确认",onCancel:n,onOk:this.onOk,width:600,bodyStyle:{padding:0},className:B.a.countDown,centered:!0},S.a.createElement(s.a,{message:S.a.createElement("div",{style:{color:"rgba(64, 138, 255, 0.7)",fontSize:14}},S.a.createElement(F,{type:"iconwenhao1"}),S.a.createElement("span",null,"『技术支持』邮箱默认为dataone团队邮箱，当用户无法解决『消息列表』内通知任务异常时，可通过此邮箱联系dataone团队，邮箱地址可根据实际情况修改 ")),banner:!0,showIcon:!1,style:{color:"#408AFF",background:"#F5F9FD",padding:"15px",marginBottom:10,fontSize:12}}),S.a.createElement(o.a,Object.assign({},O,{ref:this.formRef,name:"userForm",initialValues:i()({},"oldEmail",this.state.skill_email)}),S.a.createElement(o.a.Item,{name:"oldEmail",label:"原邮箱地址"},S.a.createElement(l.a,{disabled:!0})),S.a.createElement(o.a.Item,{name:"email",label:"新邮箱",validateTrigger:"onBlur",rules:[{required:!0,whitespace:!0,message:"邮箱不能为空，请输入邮箱地址"},{type:"email",message:"您输入的邮箱格式错误，请重新输入！"}]},S.a.createElement(l.a,{type:"email",placeholder:"请输入新邮箱地址",onChange:function(a){return e.setState({value:a.target.value,color:!!a.target.value})}})),S.a.createElement(o.a.Item,{name:"authCode",label:"验证码",validateTrigger:"onBlur",rules:[{required:!0,message:"请输入验证码"}]},S.a.createElement(l.a,{suffix:S.a.createElement("div",null,S.a.createElement("a",{type:"primary",onClick:this.state.color?this.getverification:null,style:{float:"right",width:70,padding:0,textAlign:"center",color:this.state.color?"#F1B00A":"#a7abb9",display:this.state.verification?"block":"none"}},this.state.reload?"获取验证码":"重新发送"),S.a.createElement(V,{style:{float:"right",width:120,fontSize:14,textAlign:"center",display:this.state.verification?"none":"block",cursor:"pointer"},format:"重新发送(s秒)",value:0==this.state.verification?this.state.deadline:null,onFinish:this.onFinish})),type:"code",placeholder:"请输入验证码"}))))}}]),t}(S.a.Component),D=function(a){function t(){var a;return u()(this,t),(a=E()(this,v()(t).apply(this,arguments))).state={selectItem:"1",stepValue:"1",dept_name:"",user_name:"1"===localStorage.getItem("role_id")?"admin":""},a.personal=function(){N()({method:"post",url:e.constants.httpType+e.constants.website+"/sys_user/personal/",headers:{authToken:localStorage.getItem("authToken")}}).then(function(e){"401"==e.data.status&&(window.location.href="/user"),a.setState({formValues:e.data.data,user_name:e.data.data.user_name,dept_name:e.data.data.dept_name,count_job:e.data.data.count_job,email:e.data.data.email,user_id:e.data.data.user_id,password:e.data.data.password,emailSupport:e.data.data.skill_email})}).catch(function(e){})},a.onChange=function(){a.setState({stepValue:"2"})},a.showModal=function(e){1==e?a.setState({visible:!0}):2==e?a.setState({visiblePassword:!0}):3==e?a.setState({visibleEmail:!0}):4==e&&a.setState({visibleEmailSupport:!0})},a.handleCancel=function(){a.setState({visible:!1,visiblePassword:!1,visibleEmail:!1,visibleEmailSupport:!1})},a.handleCreate=function(){},a.handleAdd=function(t){var n=e.constants.httpType+e.constants.website+"/sys_user/updUserEmail/";t.userId=a.state.user_id,void 0!=t.newEmail2&&(delete t.newEmail2,delete t.email),void 0!=t.emailPassword&&(delete t.email,n=e.constants.httpType+e.constants.website+"/sys_user/updSuperEmail/"),void 0!=t.newPassword&&(delete t.newPassword2,n=e.constants.httpType+e.constants.website+"/sys_user/updPassword/"),void 0!=t.email&&(delete t.oldEmail,delete t.userId,n=e.constants.httpType+e.constants.website+"/sys_user/skillCodeEquals"),N()({method:"post",url:n,data:P.a.Amap(t),headers:{authToken:localStorage.getItem("authToken")}}).then(function(e){if("401"==e.data.status&&(window.location.href="/user"),1==e.data.status){if(m.a.success("操作成功",2),void 0!=t.newPassword)return void(window.location.href="/");a.personal()}else if(0==e.data.status)return void m.a.error(e.data.message,2);a.setState({visible:!1,visiblePassword:!1,visibleEmail:!1,visibleEmailSupport:!1})}).catch(function(e){})},a.addSubmit=function(t){delete t.password1;var n=2;3==a.state.role_id&&(n=3),N()({method:"post",url:e.constants.httpType+e.constants.website+"/sys_user/addUser/?id="+n,data:t,headers:{authToken:localStorage.getItem("authToken")}}).then(function(e){"401"==e.data.status&&(window.location.href="/user"),1==e.data.status?(m.a.success("操作成功",2),a.setState({userid:e.data.id,stepValue:"2"})):m.a.error(e.data.message,2)}).catch(function(e){})},a}return b()(t,a),h()(t,[{key:"componentDidMount",value:function(){this.personal()}},{key:"render",value:function(){var e=this;return S.a.createElement(k.a,{className:B.a.layoutBox},S.a.createElement(x,{style:{background:"#fff",padding:24,minHeight:280}},S.a.createElement(n.a,{title:"账号设置"},S.a.createElement("div",{className:B.a.personalBox},S.a.createElement("p",null,S.a.createElement("span",{className:B.a.firstSpan},"用户名 :"),S.a.createElement("span",{className:B.a.emailBox},S.a.createElement("span",{className:B.a.secondSpan,title:this.state.user_name},this.state.user_name.length>20?this.state.user_name.substring(0,20)+"...":this.state.user_name))),S.a.createElement("p",{style:{display:"1"===localStorage.getItem("role_id")?"none":"block"}},S.a.createElement("span",{className:B.a.firstSpan},"小组 :"),S.a.createElement("span",{className:B.a.emailBox},S.a.createElement("span",{className:B.a.secondSpan,title:this.state.dept_name},this.state.dept_name.length>20?this.state.dept_name.substring(0,20)+"...":this.state.dept_name))),S.a.createElement("p",{style:{display:"1"===localStorage.getItem("role_id")?"none":"block"}},S.a.createElement("span",{className:B.a.firstSpan},"已参与任务数 :"),S.a.createElement("span",{className:B.a.emailBox},S.a.createElement("span",{className:B.a.secondSpan},this.state.count_job))),S.a.createElement("p",{style:{display:"1"===localStorage.getItem("role_id")?"block":"none"}},S.a.createElement("span",{className:B.a.firstSpan},"系统邮箱:"),S.a.createElement("span",{className:B.a.emailBox},S.a.createElement("span",{className:B.a.secondSpan},this.state.email),S.a.createElement(I.a,{onClick:function(){return e.showModal(3)}}))),S.a.createElement("p",{style:{display:"1"===localStorage.getItem("role_id")?"none":"block"}},S.a.createElement("span",{className:B.a.firstSpan},"邮箱:"),S.a.createElement("span",{className:B.a.emailBox},S.a.createElement("span",{className:B.a.secondSpan},this.state.email),S.a.createElement(I.a,{onClick:function(){return e.showModal(1)}}))),S.a.createElement("p",null,S.a.createElement("span",{className:B.a.firstSpan},"密码 :"),S.a.createElement("span",{className:B.a.emailBox},S.a.createElement("span",{className:B.a.secondSpan},"******"),S.a.createElement(I.a,{onClick:function(){return e.showModal(2)}}))),S.a.createElement("p",{style:{display:"1"===localStorage.getItem("role_id")?"block":"none"}},S.a.createElement("span",{className:B.a.firstSpan},"技术支持邮箱:"),S.a.createElement("span",{className:B.a.emailBox},S.a.createElement("span",{className:B.a.secondSpan},this.state.emailSupport),S.a.createElement(I.a,{onClick:function(){return e.showModal(4)}})))),this.state.visible?S.a.createElement(R,{visible:this.state.visible,onCancel:this.handleCancel,handleAdd:function(a){return e.handleAdd(a)},ifCreat:!1,onCreate:function(){return e.handleCreate()},formValues:this.state.formValues}):null,this.state.visibleEmail?S.a.createElement(j,{visible:this.state.visibleEmail,onCancel:this.handleCancel,handleAdd:function(a){return e.handleAdd(a)},ifCreat:!1,onCreate:function(){return e.handleCreate()},formValues:this.state.formValues}):null,this.state.visibleEmailSupport?S.a.createElement(z,{visible:this.state.visibleEmailSupport,onCancel:this.handleCancel,handleAdd:function(a){return e.handleAdd(a)},ifCreat:!1,onCreate:function(){return e.handleCreate()},formValues:this.state.formValues}):null,this.state.visiblePassword?S.a.createElement(q,{visible:this.state.visiblePassword,onCancel:this.handleCancel,handleAdd:function(a){return e.handleAdd(a)},ifCreat:!1,onCreate:function(){return e.handleCreate()},formValues:this.state.formValues}):null)))}}]),t}(C.PureComponent);a.default=D}.call(this,t("yLpj"))}}]);